---
title: Client Development
description: Development of SyncFlow Clients
---


# Syncflow Node Client Development

## Overview

A real-time collaboration application using:
- ExpressJS backend
- Vite-Express rendering
- Syncflow token management
- LiveKit WebRTC communication

## File Structure

### Backend Components
- Server configuration with Syncflow Node Client
- Token generation endpoint
- Session management

### Frontend Components
- Dynamic HTML rendering
- Interactive room joining interface
- LiveKit-powered video communication

## Server Implementation

### Key Server Features

#### Environment and Middleware
- Loads environment variables
- Configures JSON body parsing
- Creates Express application

#### Response Utility Functions
```javascript
const jsonOkResponse = (res, data) => {
    return res.status(200).json(data);
};

const errorResponse = (res, error) => {
    return res.status(500).json({ error: error.message });
};
```

#### Token Generation Endpoint
- Handles room and identity token requests
- Checks for existing active sessions
- Creates new sessions if needed
- Generates comprehensive video grants

#### Session Management Logic
- Filters active sessions
- Supports dynamic room creation
- Generates tokens with extensive permissions

### Project Client Initialization
```javascript
const projectClient = new ProjectClientBuilder()
    .setServerUrl(process.env.SYNCFLOW_SERVER_URL)
    .setApiKey(process.env.SYNCFLOW_API_KEY)
    .setApiSecret(process.env.SYNCFLOW_API_SECRET)
    .setProjectId(process.env.SYNCFLOW_PROJECT_ID)
    .build();
```
# Client-Side Implementation

## Client File Structure
- `main.js`: Handles initial page rendering and room joining setup
- `room.js`: Contains room connection and video handling logic

## Main.js

### Responsibilities
- Dynamically generates HTML structure
- Initializes room joining functionality

### Key Implementation
```javascript
import { joinRoom } from './room';
import './style.css';

// Dynamically inject HTML content
document.querySelector('#app').innerHTML = `...`;

// Attach room joining event listener
joinRoom(document.querySelector('#join_room'));
```

#### HTML Structure
- Left Panel: Session joining controls
  - Identity input
  - Room name input
  - Join Room button
  - Participants list placeholder
- Main Panel: Video container

## Room.js

### Room Joining Mechanism

#### Token Acquisition Workflow
```javascript
fetch('/token', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ identity, roomName })
})
```

#### LiveKit Room Configuration
```javascript
const livekitRoom = new Room({
    adaptiveStream: true,     // Dynamic video quality management
    dynacast: true,           // Bandwidth optimization
    videoCaptureDefaults: {
        resolution: VideoPresets.h720.resolution
    },
    stopLocalTrackOnUnpublish: true
});
```

### Connection Process
1. Validate user inputs
2. Request token from server
3. Prepare LiveKit room connection
4. Connect to room
5. Enable local camera
6. Display local video

### Video Display Function
```javascript
function displayLocalVideo(participant, trackPublication) {
    const video = trackPublication.track.attach();
    
    // Set metadata attributes
    video.setAttribute('data-identity', participant.identity);
    video.setAttribute('data-participant-sid', participant.sid);
    
    // Configure video dimensions
    video.setAttribute('width', '300');
    video.setAttribute('height', '300');
    
    // Append to video container
    document.querySelector('#video-container').appendChild(video);
}
```

## Key Features
- Dynamic HTML rendering
- Token-based authentication
- LiveKit WebRTC integration
- Adaptive video streaming
- Error handling
- Metadata tracking

## Error Handling
- Input validation
- Token request error catching
- Connection error management
- Camera/microphone activation errors

## Performance Optimizations
- Adaptive streaming
- Dynacast bandwidth optimization
- 720p default video resolution

## Potential Enhancements
1. Add participant list population
2. Implement leave room functionality
3. Create device selection controls
4. Add more granular video/audio settings

## Browser Compatibility
- Requires modern browsers supporting:
  - WebRTC
  - ES6+ JavaScript
  - Fetch API

## Key Technologies
- Backend: Node.js, Express
- Frontend: Vanilla JavaScript
- WebRTC: LiveKit
- Rendering: Vite-Express

## Deployment Considerations
- Environment variable configuration
- Port configuration (default: 3000)
- Secure token management

## Potential Improvements
1. Enhanced error handling
2. Session expiration logic
3. Advanced authentication
4. Comprehensive logging

## Security Notes
- Token-based authentication
- Server-side token generation
- Controlled room access